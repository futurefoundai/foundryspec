rules:
  - id: persona-gate
    name: Persona Architecture Gate
    level: folder
    description: "Personas must be mindmaps with Role, Description, and Goals to support consistent user modeling."
    target:
      idPrefix: PER_
      pathPattern: "personas/*"
    type: structural
    enforcement: error
    checks:
      mermaidType: mindmap
      requiredExtension: mermaid
      requiredNodes: [Role, Description, Goals]
      traceability:
        mustHaveDownlink: [JRN_]
    hub:
      id: GRP_Personas
      title: Personas

  - id: journey-syntax
    name: Journey Strict Syntax
    level: folder
    description: "Journeys must be sequence diagrams and must trace to a Persona (User)."
    target:
      idPrefix: JRN_
      pathPattern: "journeys/*"
    type: syntax
    enforcement: error
    checks:
      mermaidType: sequenceDiagram
      requiredExtension: mermaid
      allowedNodePrefixes: [PER_, CTX_, BND_, COMP_]
      traceability:
        mustTraceTo: [PER_]
    hub:
      id: GRP_Journeys
      title: Journeys

  - id: requirement-syntax
    name: Requirement Syntax
    level: folder
    description: "Requirements must use specific Mermaid syntax for automated traceability."
    target:
      idPrefix: REQ_
      pathPattern: "requirements/*"
    type: syntax
    enforcement: error
    checks:
      mermaidType: requirementDiagram
      requiredExtension: mermaid
      traceability:
        mustTraceTo: [PER_, REQ_]
        mustHaveDownlink: [FEAT_, COMP_, CTX_, BND_, REQ_]
    hub:
      id: GRP_Requirements
      title: Requirements

  - id: context-registration
    name: Context Model Registration
    level: folder
    description: "Registers Context models for the Hub. Context models use graph syntax."
    target:
      idPrefix: CTX_
      pathPattern: "context/*"
    type: syntax
    enforcement: error
    checks:
      mermaidType: graph
      requiredExtension: mermaid
      traceability:
        mustHaveDownlink: [BND_, COMP_, FEAT_]
    hub:
      id: GRP_Context
      title: Context

  - id: boundary-registration
    name: Boundary Definition Registration
    level: folder
    description: "Registers Boundary definitions for the Hub. Boundary models use graph syntax."
    target:
      idPrefix: BND_
      pathPattern: "boundaries/*"
    type: syntax
    enforcement: error
    checks:
      mermaidType: graph
      requiredExtension: mermaid
      traceability:
        mustTraceTo: [CTX_]
    hub:
      id: GRP_Boundaries
      title: Boundaries

  - id: component-registration
    name: Component Registration
    level: folder
    description: "Registers Components for the Hub. Component models must be classDiagrams."
    target:
      idPrefix: COMP_
      pathPattern: "components/*"
    type: syntax
    enforcement: error
    checks:
      mermaidType: classDiagram
      traceability:
        mustTraceTo: [CTX_, REQ_, BND_]
    hub:
      id: GRP_Components
      title: Components

  - id: footnotes-policy
    name: Footnotes Markdown Policy
    level: file
    description: "Footnotes are supplementary and must be in Markdown format."
    target:
      pathPattern: "**/footnotes/*"
    type: structural
    enforcement: error
    checks:
      requiredExtension: md
      requiredFrontmatter: [title, description, id]

  - id: core-metadata
    name: Core Document Metadata
    level: file
    description: "Every file requires standard frontmatter for identification and Hub integration."
    target:
      pathPattern: "**/*.mermaid"
    type: metadata
    enforcement: error
    checks:
      requiredFrontmatter: [title, description, id]

  - id: global-traceability
    name: Global Document Traceability
    level: project
    description: "To maintain 100% intent-to-code integrity, every document (node) must be reachable from the Hub Root."
    target:
      pathPattern: "**/*.{mermaid,md}"
    type: traceability
    enforcement: error
    checks:
      traceability:
        mustBeLinked: true

  - id: data-registration
    name: Data Model Registration
    level: folder
    description: "ER diagrams accessible per-node via context menu for AI collaboration."
    target:
      idPrefix: DATA_
      pathPattern: "data/*"
    type: structural
    enforcement: error
    checks:
      mermaidType: erDiagram
      requiredExtension: mermaid
      onePerFile: true
      traceability:
        mustBeLinked: true

  - id: sequence-registration
    name: Sequence Registration
    level: folder
    description: "Process sequences accessible per-node via context menu. Participants must be valid ecosystem nodes."
    target:
      idPrefix: SEQ_
      pathPattern: "sequences/*"
    type: structural
    enforcement: error
    checks:
      mermaidType: sequenceDiagram
      requiredExtension: mermaid
      onePerFile: true
      allowedNodePrefixes: [COMP_, BND_, CTX_, DATA_, FLOW_, STATE_]
      traceability:
        mustTraceTo: [COMP_, BND_, CTX_]
        mustBeLinked: true

  - id: flow-registration
    name: Flow Registration
    level: folder
    description: "Logical flows accessible per-node via context menu for AI collaboration."
    target:
      idPrefix: FLOW_
      pathPattern: "flows/*"
    type: structural
    enforcement: error
    checks:
      mermaidType: flowchart
      requiredExtension: mermaid
      onePerFile: true
      traceability:
        mustBeLinked: true

  - id: state-registration
    name: State Machine Registration
    level: folder
    description: "State machines accessible per-node via context menu for modeling behavior."
    target:
      idPrefix: STATE_
      pathPattern: "states/*"
    type: structural
    enforcement: error
    checks:
      mermaidType: stateDiagram
      requiredExtension: mermaid
      onePerFile: true
      traceability:
        mustBeLinked: true

