<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{projectName}} - Diagram Viewer</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="index.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
  </head>
  <body>
    <div id="header">
      <button id="back-button">‚Üê Back</button>
      <h1>{{projectName}}</h1>
      <div id="breadcrumbs"></div>
    </div>
    <div id="viewer">
      <div class="diagram-container" id="diagram-container"></div>
    </div>

    <div id="modal-backdrop" onclick="closeModal(event)">
      <div id="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
          <h2
            id="modal-title"
            style="
              margin: 0;
              font-family: 'Outfit', sans-serif;
              font-size: 1.25rem;
            "
          >
            Details
          </h2>
          <button class="close-btn" onclick="closeModal()">&times;</button>
        </div>
        <div id="modal-body" class="modal-body"></div>
      </div>
    </div>

    <!-- Context Menu -->
    <div id="context-menu">
      <div class="menu-item" id="menu-view-comments">View Comments</div>
      <div class="menu-item" id="menu-add-comment">Add Feedback</div>
    </div>

    <!-- Comment Overlay -->
    <div id="comment-overlay">
      <div id="comment-list"></div>
      <textarea class="comment-input" id="new-comment-input" placeholder="Enter feedback..." rows="3"></textarea>
      <div style="display: flex; justify-content: flex-end; gap: 0.5rem; margin-top: 0.5rem;">
        <button onclick="closeCommentOverlay()" style="background: transparent; border: none; color: #94a3b8; cursor: pointer; font-size: 0.8rem;">Cancel</button>
        <button id="save-comment-btn" style="background: #38bdf8; border: none; color: #0f172a; padding: 0.2rem 0.8rem; border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 0.8rem;">Save</button>
      </div>
    </div>

    <!-- Initialization & External Logic -->
    <script>
      // Injected by FoundrySpec
      const idMap = {{idMap}};
      const projectName = "{{projectName}}";
      const projectId = "{{projectId}}";
      const projectVersion = "{{version}}";
    </script>
    <script src="index.js"></script>
  </body>
</html>
