---
id: "COMP_Overview"
title: Component Architecture
description: Detailed decomposition of the FoundrySpec engine components.
entities:
  - id: "COMP_Group"
    requirements:
  - id: "COMP_ClickInterceptor"
    requirements:
  - id: "COMP_InteractiveComments"
    requirements:
  - id: "COMP_BuildManager"
    requirements:
  - id: "COMP_MermaidParser"
    requirements:
  - id: "COMP_ProbeManager"
    requirements:
  - id: "COMP_ConfigStore"
    requirements:
  - id: "COMP_GitManager"
    requirements:
  - id: "COMP_CLI"
    requirements:
  - id: "COMP_DevServer"
    requirements:
  - id: "COMP_RuleEngine"
    requirements:
  - id: "COMP_SidebarControllers"
    description: "Handles the logic for the context sidebar and unified ID resolution."
  - id: "COMP_PersonaDrawer"
    description: "Specialized UI component for managing persona-specific metadata."
    requirements: REQ_InteractiveComments
  - id: "COMP_PersonaViewer"
    description: "Web Component for interactive Persona mindmaps."
    requirements: REQ_UX
  - id: "COMP_DiagramViewer"
    description: "Base Web Component class for rendering and interacting with Mermaid diagrams."
    requirements: REQ_Discovery
  - id: "COMP_DiagramLoader"
    description: "Central logic for fetching and transitions between views."
    requirements: REQ_Discovery
  - id: "COMP_ViewerFactory"
    description: "Strategy-based factory for instantiating specialized diagram viewers."
    requirements: REQ_Discovery
  - id: "COMP_BrowserPool"
    requirements:
  - id: "COMP_Hub"
    requirements:
  - id: "COMP_Engine"
    requirements:
---

classDiagram
    class COMP_Hub {
        <<Component>>
        +Visualizer
        +Editor
    }

    class COMP_Engine {
        <<Component>>
        +RuleEngine
        +BuildManager
    }

    class COMP_Group {
        <<Component>>
        +ScaffoldManager
        +TemplateRegistry
    }

    class COMP_BuildManager {
        <<Component>>
        +ValidationEngine
        +AssetLoader
        +SyntheticGenerator
    }

    class MermaidParser {
        <<Service>>
        +parseWithCache(file, content)
        +flush()
    }

    class BrowserPool {
        <<Singleton>>
        +getBrowser()
        +close()
    }

    class COMP_ProbeManager {
        <<Component>>
        +CodeScanner
        +DriftDetector
    }

    class COMP_ClickInterceptor {
        <<Component>>
        +SmartInterceptor
        +IdMapResolver
    }

    class COMP_InteractiveComments {
        <<Component>>
        +CommentManager
        +SidebarUI
    }

    class COMP_DevServer {
        <<Component>>
        +FileWatcher
        +ApiHandler
        +StaticServer
    }

    class COMP_ConfigStore {
        <<Component>>
        +GlobalState
        +IdentityManager
    }

    class COMP_GitManager {
        <<Component>>
        +RepoSync
        +SpecPuller
    }

    class COMP_CLI {
        <<Component>>
        +CommandRegistry
        +Entrypoint
    }

    class COMP_RuleEngine {
        <<Component>>
        +ValidationEngine
        +Scanner
    }
    
    class COMP_SidebarControllers {
        <<Component>>
        +UIState
        +Resolver
    }

    class COMP_PersonaViewer {
        <<WebComponent>>
        +SemanticActions
        +MindmapHandler
    }

    class COMP_PersonaDrawer {
        <<Component>>
        +DrawerUI
        +ActionHandlers
    }

    class COMP_DiagramLoader {
        <<Logic>>
        +loadDiagram()
        +reload()
    }

    class COMP_DiagramViewer {
        <<WebComponent>>
        +PanZoom
        +Renderer
    }

    class COMP_ViewerFactory {
        <<Service>>
        +create()
    }
    
    COMP_CLI --> COMP_BuildManager : triggers
    COMP_CLI --> COMP_ProbeManager : triggers
    COMP_CLI --> COMP_DevServer : starts
    COMP_CLI --> COMP_GitManager : uses
    COMP_BuildManager --> COMP_ConfigStore : uses
    COMP_BuildManager --> COMP_RuleEngine : orchestrates
    COMP_BuildManager --> MermaidParser : uses
    MermaidParser --> BrowserPool : leverages
    MermaidParser --> COMP_RuleEngine : uses analyzers
    COMP_ProbeManager --> COMP_BuildManager : uses
    COMP_BuildManager --> COMP_Group : uses template
    COMP_DevServer --> COMP_BuildManager : triggers rebuild
    COMP_InteractiveComments --> COMP_SidebarControllers : coordinates
    COMP_SidebarControllers --> COMP_PersonaDrawer : delegates
    COMP_SidebarControllers --> COMP_ViewerFactory : utilizes
    COMP_ViewerFactory --> COMP_DiagramViewer : instantiates
    COMP_ViewerFactory --> COMP_PersonaViewer : instantiates
    COMP_DiagramLoader --> COMP_ViewerFactory : requests
    COMP_Hub --> COMP_DiagramLoader : uses

