sequenceDiagram
    participant Agent as AI Agent
    participant CLI
    participant BuildManager
    participant FS as Local Filesystem
    participant Puppeteer as Headless Browser
    participant MermaidJS as Mermaid.js Library

    Agent->>CLI: foundryspec build
    CLI->>BuildManager: new BuildManager()
    CLI->>BuildManager: build()
    
    BuildManager->>FS: Read "foundry.config.json"
    BuildManager->>FS: Scan "assets/" for categories
    
    BuildManager->>Puppeteer: launch()
    activate Puppeteer

    loop For each Category
        BuildManager->>FS: Scan for .mermaid files
        loop For each Diagram
            BuildManager->>FS: Read content
            BuildManager->>BuildManager: validateDiagramLinks()
            BuildManager->>Puppeteer: newPage()
            Puppeteer->>MermaidJS: parse(content)
        end
    end
    
    deactivate Puppeteer
    BuildManager->>Puppeteer: close()

    BuildManager->>BuildManager: generateHub()
    BuildManager->>FS: Write "index.html" (Hub)
    BuildManager->>FS: Write "assets/CAT/index.html" (Viewer)
    BuildManager->>FS: Copy core assets to dist/
    
    BuildManager-->>CLI: Build Success
    CLI-->>Agent: âœ… Build complete!
